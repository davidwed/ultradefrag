;===============================================================================
;
; This file will contain developer's diary, in other words, plans for future,
; current development status and so on.
;
;===============================================================================



;-------------------------------------------------------------------------------
; 
; 1 December 2009 - the following notes were found somewhere, they were written
; approx. two years ago and I forgot about them
;
;-------------------------------------------------------------------------------

Part I:

- In version 1.2.4 and later versions cluster map for very small volumes
   can be very inaccurate. P.a., one strange disk contains just 500 clusters.
   But internally they are represented (in 1.2.4 version of program) 
   by 728 blocks. Therefore we have one block (728 / 500) per cluster 
   plus 229 blocks for the last one. 
   So, the bottom part of the cluster map is invalid.

- Project targets are:
   - for end users: simplicity, high speed processing, nice gui
   - for developers: windows hacking

- Udefrag.dll and zenwinx.dll are components critical for
    windows boot process. If one of them is missing and boot time defrag is
    enabled, you will see BSOD at boot time, and Last Known Good configuration 
    will be not helpful. Currently I don't know how make our software absolutely
    safe.

- Rxvt (from MSYS; tested version is 2.7.2) terminates udefrag.exe when 
    you press Ctrl + C without special message sending (for CtrlHandlerRoutine).
    Therefore, unload function will never executed, 
    and driver will not be unloaded.
    This is a bug of rxvt.

- If you terminate dfrg.exe or udefrag.exe (using task manager or rxvt) then 
    you will have small memory leak (16 bytes) from the nonpaged pool.
    Reboot is required to free this memory.

Part II:

User's wishes for the next releases:

- website translated into several foreign languages
- make screensaver
- defragment volumes that doesn't have any letter assigned
- implement partially defragmentation
- process hard ntfs links correctly

;-------------------------------------------------------------------------------
; 
; one month later: 21 November 2009
;
;-------------------------------------------------------------------------------

They were tested Windows DDK with all available optimization keys (including /Od), 
latest Windows SDK, Pelles C compiler and MinGW x64. Unfortunately each of them 
produces wrong x64 code. Therefore we cannot provide 64-bit native binaries 
at this moment.

Since the 3.3.0 release we'll provide two different forms of binaries:
 - full featured 32-bit packages (with kernel mode driver and boot time interface)
 - portable packages

Portable packages will be native 32-bit, therefore kernel mode driver and boot 
time interface will not be available on 64-bit systems. On the other hand, 
all remaining features of the program will be well supported. In addition, 
portable packages will not require installation, which is another advantage over 
an old portable packages.

After resolving x64 compilation problems the following tests must be performed:
 - boot time interface: USB and PS/2 keyboards at startup and in interactive mode
 - gui accelerators

;-------------------------------------------------------------------------------
;
; one additional note (11 October 2009):
;
;-------------------------------------------------------------------------------

x64 compiler included in Windows Server 2003 DDK sometimes produces 
wrong code. We need to find better replacement for it.

;-------------------------------------------------------------------------------
;
; Updated plans for future (8 October 2009):
;
;-------------------------------------------------------------------------------

DOS version development is a little bit difficult due to the missing universal 
sectors reading function in this operating system. Therefore we will develop it 
under an experimental basis when we will have free time enough for that. I'm 
not sure that it will be particularly useful.

Instead of working on separate DOS version of the program I plan to complete 
the final 3.2.x Windows version. This point will be achieved for educational 
purposes: the final version of the driver will be helpful for all the people 
who are interested in Windows Kernel architecture.

After achieving this final point I'll work on a driver replacement. All kernel 
mode code will be ported to a single native DLL. This gives us the following 
advantages: better support for modern versions of Windows regards to solving 
a driver signing problem, better reliability and more simplified code.

First of all I will port all defragmenter's code to a single udefrag-kernel.dll.
Later I'll perform full set of tests to compare it with driver.

;-------------------------------------------------------------------------------
;
; Plans for future (7 October 2009):
;
;-------------------------------------------------------------------------------

1. Add UD_FRAGMENTS_THRESHOLD filter parameter.
2. Improve filters by excluding more files.
3. Add full support for USB keyboards and PS/2 keyboards on x64 systems.

After these 3 steps program goes into maintenance mode. New releases will 
contain new language packs, bugfixes (when some bugs will be reported) and 
improvements (when something interesting will be suggested). Also we will 
continue to provide technical support to program users.

All the features non listed above but suggested by users are in our opinion 
optional features. Their implementation seems to be too difficult though 
the result seems to be not so great. Maybe we will implement some things 
in future, but this is not a main goal for next days.

We have one better thing to do in future: UltraDefrag for DOS seems to be 
a really cool software, useful for these gamers who prefers old good games 
written especially for DOS.

To get more information about UltraDefrag for DOS check out the /src/DOS 
subdirectory contents of our SVN repository.

Thanks for comprehension.
