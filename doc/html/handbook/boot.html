<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<title>Chapter 5. Boot time defragmentation</title>
	<link rel="stylesheet" href="kde-default.css" type="text/css" />
	<link rel="stylesheet" href="udefrag.css" type="text/css" />
	<meta name="description" content="Ultra Defragmenter is a powerful Open Source defragmentation tool for Windows NT." />
	<meta name="keywords" content="UltraDefrag, Ultra Defragmenter, defragmentation, Open Source disk defragmenter, defragger, boot time defragmentation, boot time defragger, handbook, user manual, boot time defragmentation, native executable" />
	<link rel="start" href="index.html" title="Ultra Defragmenter Handbook" />
	<link rel="prev" href="console.html" title="Chapter 4. Graphical interface" />
	<link rel="next" href="reports.html" title="Chapter 6. Reports" />
</head>

<body bgcolor="white" text="black" alink="#0000ff" link="#0000ff" vlink="#840084">

<div style="background-image: url(top-middle.png); width: 100%; height: 131px;">
	<div style="position: absolute; right: 0px;">
		<img src="top-right-konqueror.png" style="margin: 0px;" alt="" />
	</div>

	<div style="position: absolute; top: 25px; right: 100px; text-align: right; font-size: xx-large; font-weight: bold; text-shadow: #fff 0px 0px 5px; color: #444;">
	Boot time defragmentation</div>
</div>

<div style="margin-top: 20px; background-color: white; color: black; margin-left: 20px; margin-right: 20px;">
	<div style="position: absolute; left: 20px;"><a accesskey="p" href="gui.html">Prev</a></div>

	<div style="position: absolute; right: 20px;"><a accesskey="n" href="reports.html">Next</a></div>

	<div class="navCenter">&nbsp;</div>
</div>

<div class="chapter" lang="en">
	<div class="titlepage">
		<div><div>
				<h2 class="title">Chapter 5. Boot time defragmentation</h2>
		</div></div>
	</div>

	<div class="toc">
		<p><b>Table of Contents</b></p>
		<dl>
			<dt><span class="sect1"><a href="boot.html#overview">Overview</a></span></dt>
			<dt><span class="sect1"><a href="boot.html#script">Boot time script</a></span></dt>
			<dt><span class="sect1"><a href="boot.html#commands">Supported commands</a></span></dt>
			<dt><span class="sect1"><a href="boot.html#interactive">Interactive mode</a></span></dt>
			<dt><span class="sect1"><a href="boot.html#examples">Examples</a></span></dt>
		</dl>
	</div>
	
	<div class="sect1" lang="en">
		<div class="titlepage">
			<div><div>
				<h2 class="title" style="clear: both"><a name="overview"></a>
				Overview</h2>
			</div></div>
		</div>
		<p><span class="application">UltraDefrag</span> also includes a new mode
		that allows you to run it at boot time in a manner similar to chkdsk.
		This is known as a native application. It provides an ability to defragment any system files. 
		Including page file, registry hives, hiberfil.sys file, another files locked by system 
		or applications. Native <span class="application">UltraDefrag</span> runs before any file 
		locking, therefore it can process them as an ordinary files.</p>
		<p><div align="center"><img src="ud-boot-time.png" alt="Boot time defragmenter" align="bottom" border="0"></div></p>
		<p>If the boot time defragmenter is enabled, you will see such picture at every reboot. Note 
		that you will have a chance to exit safely without a driver loading, just press any key when 
		the appropriate prompt will be shown. If no key will be pressed during this phase, the boot 
		time script will be interpreted and executed.
		</p>
		<p>The only restriction on
		boot time scans is that you may not scan encrypted volumes. This is because
		lsass.exe, the component of the operating system that reads encrypted volumes,
		is loaded after the native executable runs.</p>
		<p>To enable the boot time defragmenter open 
		<a href="gui.html#config">UltraDefrag GUI Configurator</a> and check 
		<span class="guimenuitem">Enable</span> box in <span class="guimenuitem">Boot time scan</span> 
		section.
		The boot time defragmenter can also be enabled by <span class="code">boot-on</span> command 
		typed in the command line. To disable them use the <span class="code">boot-off</span> command. 
		</p>
	</div>

	<div class="sect1" lang="en">
		<div class="titlepage">
			<div><div>
				<h2 class="title" style="clear: both"><a name="script"></a>Boot time script</h2>
			</div></div>
		</div>
		<p>To edit the boot time script (contained in 
		<span class="code">%windir%\system32\ud-boot-time.cmd</span> file) type in command prompt 
		<span class="code">boot-config</span> or click <span class="guimenuitem">Script</span> 
		button in <a href="gui.html#config">UltraDefrag GUI Configurator</a>.
		</p>
		<p>The script contains defragmentation related commands and comments. To understand better 
		commands used here, read please carefully the <a href="console">console interface</a> 
		section of this document.</p>
		<p>The strings with a semicolon (<span class="code">;</span>) or # characters 
		in the beginning are comments.</p>
	</div>

	<div class="sect1" lang="en">
		<div class="titlepage">
			<div><div>
				<h2 class="title" style="clear: both"><a name="commands"></a>Supported commands</h2>
			</div></div>
		</div>
		<p>The boot time script may contain the following commands.</p>
		<table border="1" cellpadding="5" style="padding: 0px;"><tbody>
			<tr>
			<td class="code">@echo on</td><td>Show commands on the screen. This is the default behaviour.</td>
			</tr>
			<tr>
			<td class="code">@echo&nbsp;off</td><td>Disable showing commands on the screen.</td>
			</tr>
			<tr>
			<td class="code">set</td>
			<td>Set specified environment variable. The usage is the same as described in 
			<a href="#console">console application</a> section of this document.
			</td>
			</tr>
			<tr>
			<td class="code">udefrag</td>
			<td>
			This command has the same options as the <a href="#console">console interface</a>.
			</td>
			</tr>
			<tr>
			<td class="code">pause</td><td>Pause the script execution for the specified interval (in milliseconds). 
			P.a. the command <span class="code">pause 1000</span> will pause execution for one second.</td>
			</tr>
			<tr>
			<td class="code">shutdown</td><td>Halt the computer.</td>
			</tr>
			<tr>
			<td class="code">reboot</td><td>Reboot the computer.</td>
			</tr>
			<tr>
			<td class="code">exit</td><td>Break the boot time program execution.</td>
			</tr>
		</tbody></table>
		<p> Any other commands will be ignored. When the defragger encounters the wrong syntax 
		it shows the appropriate message and continues the script execution.</p>
	</div>

	<div class="sect1" lang="en">
		<div class="titlepage">
			<div><div>
				<h2 class="title" style="clear: both"><a name="interactive"></a>
				Interactive mode</h2>
			</div></div>
		</div>
		<p>You can run the boot time defragmenter in interactive mode. Just comment the 
		<span class="code">exit</span> command in script to leave the program to be running after 
		the last command execution.</p>
		<p>In interactive mode program shows a prompt like this:</p>
<pre width="80pt" class="screen"><strong class="userinput"><code>Interactive mode:
Type 'help' for list of supported commands.

#
</code></strong></pre>
		<p>Currently there are just few simple commands supported in this mode. Of course, in future 
		this mistake will be reclaimed :) To show list of supported commands type 
		<span class="code">help</span>. To continue the Windows	Boot Process 
		type <span class="code">exit</span>.</p>
	</div>

	<div class="sect1" lang="en">
		<div class="titlepage">
			<div><div>
				<h2 class="title" style="clear: both"><a name="examples"></a>
				Examples</h2>
			</div></div>
		</div>
		<p>The complete example, installed by default:
		</p>
<pre width="80pt" style="border: 1px solid black; color: black; 
background-color: #ffffe1; font-size: 10pt;">
;--------------------------------------------------------------------
;                UltraDefrag Boot Time Shell Script
;--------------------------------------------------------------------
; !!! NOTE: THIS FILE MUST BE SAVED IN UNICODE (UTF-16) ENCODING !!!
;--------------------------------------------------------------------

set UD_IN_FILTER=windows;winnt;ntuser;pagefile;hiberfil
set UD_EX_FILTER=temp

udefrag c:

exit

</pre>
		<p><b>Note:</b> If there is no <span class="code">exit</span> command 
		specified, the program will run in <a href="boot.html#interactive">interactive mode</a> 
		after the last script command execution.</p>
		<p><b>Hack:</b> If you are using Windows 98 operating system but you wish to use the 
		<span class="application">Ultra Defragmenter</span> to optimize your drives from time to time 
		than you have now one cool solution for that. Install Windows XP as a second operating system, 
		install <span class="application">UltraDefrag</span> on them and enable the boot time 
		defragmenter. Insert the <span class="code">reboot</span> command in the boot time script and enjoy! 
		You can simply boot Windows XP, it will defrag anything and automatically reboot the computer 
		at the end.
		</p>
	</div>

</div>

<div style="color: black; margin-top: 20px; margin-left: 20px; margin-right: 20px;">
	<div style="position: absolute; left: 20px;"><a accesskey="p" href="gui.html">Prev</a></div>

	<div style="position: absolute; right: 20px;"><a accesskey="n" href="reports.html">Next</a></div>

	<div align="center"><a accesskey="h" href="index.html">Home</a></div>
</div>

<div style="color: black; margin-left: 20px; margin-right: 20px;">
	<div class="navLeft">Graphical interface&nbsp;</div>

	<div class="navRight">&nbsp;Reports</div>

	<div class="navCenter"><a accesskey="u" href="index.html">Up</a></div>
</div>

<br />
<br />

<div class="bannerBottom" style="background-image: url(bottom-middle.png); width: 100%; height: 100px; bottom: 0px;">
	<div class="bannerBottomRight">
		<img src="bottom-right.png" style="margin: 0px;" alt="" />
	</div>
	<div class="bannerBottomLeft">
		<img src="bottom-left.png" style="margin: 0px;" alt="" />
	</div>
	<div class="bannerBottomLeft">
		<a href="http://ultradefrag.sourceforge.net/" style="position: absolute; left: 10px;">
		  <img src="udefrag124x31.gif" alt="ultradefrag.sourceforge.net" border="0" width="124" height="31" />
		</a>
		<a href="http://sourceforge.net/projects/ultradefrag" style="position: absolute; left: 134px;">
		  <img src="http://sflogo.sourceforge.net/sflogo.php?group_id=199532&amp;type=11" alt="" border="0" height="30" width="120"  />
		</a>
	</div>
</div>

<!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://apps.sourceforge.net/piwik/ultradefrag/" : "http://apps.sourceforge.net/piwik/ultradefrag/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
piwik_action_name = '';
piwik_idsite = 1;
piwik_url = pkBaseURL + "piwik.php";
piwik_log(piwik_action_name, piwik_idsite, piwik_url);
</script>
<object><noscript><p><img src="http://apps.sourceforge.net/piwik/ultradefrag/piwik.php?idsite=1" alt="piwik"/></p></noscript></object>
<!-- End Piwik Tag -->

</body>
</html>
